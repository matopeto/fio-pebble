<!DOCTYPE html>
<html lang="cs">	 	
	<head>		 		
		<meta http-equiv="X-UA-Compatible" content="IE=edge">		 		
		<meta charset="utf-8">		 		
		<title>FIO app config 		
		</title>		 		
		<meta name="viewport" content="width=device-width, initial-scale=1, target-densitydpi=medium-dpi">		 		
		<meta name="MobileOptimized" content="320">		
		<!-- IE Mobile meta header. -->		 		
		<meta name="HandheldFriendly" content="true">		 		
		<meta name="format-detection" content="telephone=no">		 		
		<link rel="stylesheet" type="text/css" media="all" href="styles.css" />		
<script type="text/javascript">
	// Get query variables
	function getQueryParam(variable, defaultValue) {
	  // Find all URL parameters
	  var query = location.search.substring(1);
	  var vars = query.split('&');
	  for (var i = 0; i < vars.length; i++) {
	    var pair = vars[i].split('=');
	
	    // If the query variable parameter is found, decode it to use and return it for use
	    if (pair[0] === variable) {
	      return decodeURIComponent(pair[1]);
	    }
	  }
	  return defaultValue || false;
	}
		window.addEventListener("load", function load(event){
    		window.removeEventListener("load", load, false); //remove listener, no longer needed
    		
    		var optionsJson = window.location.hash ? decodeURIComponent(window.location.hash).substr(1) : "{}";
    		
    		var options = {};
    		try {
    			options = JSON.parse(optionsJson);
    		} catch (e) {
			    console.log("unable to parse json: " + e)
			}
			
    		hasToken = typeof(options.hasToken) !== 'undefined' ? options.hasToken : "";
    		transactions = typeof(options.transactions) === 'undefined' ? true : options.transactions;
    		
			if (transactions) {
				document.getElementById("transactions").checked = true
			}
    		
    		var tokenInput = document.getElementById("token");
    		var savedInput = document.getElementById("saved");
    		var sendToken = false;
    		
    		if (hasToken !== "") {
    			tokenInput.style.display = 'none';
    			savedInput.value = "Token ulozen: " + hasToken;
		  		sendToken = false;
			} else {
    			savedInput.style.display = 'none';
				document.getElementById("changeButtons").style.display = 'none';
		  		sendToken = true;
			}
			
			var change = document.getElementById("change");
			change.addEventListener("click", function click(e) {
				tokenInput.style.display = 'block';
    			savedInput.style.display = 'none';
				document.getElementById("changeButtons").style.display = 'none';
				tokenInput.focus();
		  		sendToken = true;
			}, false);  
    		
			var button = document.getElementById("submit");
			button.addEventListener("click", function click(e) {
				var token = tokenInput.value;
				var options = {
					token: !sendToken ? null : token.trim(),
					transactions: document.getElementById("transactions").checked,
				};
				
				// Set the return URL depending on the runtime environment
				var return_to = getQueryParam('return_to', 'pebblejs://close#');
				
				document.location = return_to + encodeURIComponent(JSON.stringify(options));
			}, false);
			
			var cancel = document.getElementById("cancel");
			cancel.addEventListener("click", function click(e) {
				// Set the return URL depending on the runtime environment
				var return_to = getQueryParam('return_to', 'pebblejs://close#');
				
				document.location = return_to;
			}, false);    
		},false);
	</script>	 	
	</head>	 	
	<body>		 		
		<div id="page">			 			
			<div class="content">
				<h1>Konfigurace</h1>				 				
				<div class="form">					
					<div class="formIn">
						<p>
						 Token si muzete vygenerovat po prihlaseni do FIO internetoveho bankovnictvi v sekci Nastaveni/API
						</p>					 						
							<div class="row">							 								
								<label for="token">API TOKEN: 								
								</label>							 								
								<textarea name="token" cols="40" rows="3" id="token" class="input"></textarea>
								<input type="text" name="saved" value="Token ulozen" id="saved" class="input" disabled="disabled" />
							</div>						 							
							<div class="buttons" id="changeButtons">							 								
								<input id="change" type="submit" name="cancel" class="buttonGray button" value="Smazat/Upravit token" />						 							
							</div>						 							
							<div class="row">							 								
								<label class="checkboxRow clickable" for="transactions">									
									<input type="checkbox" name="checkbox" class="checkbox" id="transactions" />Zobrazit pohyby 								
								</label>						 							
							</div>						 							
							<div class="buttons">							 								
								<input id="submit" type="submit" name="send" class="button" value="Ulozit" />							 								
								<input id="cancel" type="submit" name="cancel" class="buttonGray button" value="Zrusit" />						 							
							</div>					 						
						<!--/form-->				 					
					</div>				
				</div>			 			
			</div>		 		
		</div>	 	
	</body>
</html>